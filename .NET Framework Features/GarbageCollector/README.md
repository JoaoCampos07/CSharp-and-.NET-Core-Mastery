

This example was made for .NET Framework 4.6.1 in .NET core is now different. 
So it may no work properly !! 

BUt this Dispose Pattern is more or less the same. 